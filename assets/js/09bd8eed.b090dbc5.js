/*! For license information please see 09bd8eed.b090dbc5.js.LICENSE.txt */
"use strict";(self.webpackChunk_trxn_traxion_api=self.webpackChunk_trxn_traxion_api||[]).push([[694],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>f});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,l=u(e,["components","mdxType","originalType","parentName"]),p=c(n),h=r,f=p["".concat(s,".").concat(h)]||p[h]||d[h]||a;return n?o.createElement(f,i(i({ref:t},l),{},{components:n})):o.createElement(f,i({ref:t},l))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=h;var u={};for(var s in t)hasOwnProperty.call(t,s)&&(u[s]=t[s]);u.originalType=e,u[p]="string"==typeof e?e:r,i[1]=u;for(var c=2;c<a;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},1787:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>f,contentTitle:()=>d,default:()=>b,frontMatter:()=>p,metadata:()=>h,toc:()=>y});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),i=(n(2784),["components"]),u={toc:[{value:"Installation",id:"installation",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Configuration",id:"configuration",level:2},{value:"CustomUserSelect",id:"customuserselect",level:2},{value:"Encryption",id:"encryption",level:2},{value:"Bcrypt online generator",id:"bcrypt-online-generator",level:2}]},s="wrapper";function c(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)(s,(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"authentication-module"},"Authentication Module"),(0,a.kt)("p",null,"The nestjs-authentication module is that will handle your authentication. It will\nby give you access to some standard guard to use jwt and login based strategy\nauthentication. Under the hood this module use jwt and passport to authenticate\nthe connections."),(0,a.kt)("h2",{id:"installation"},"Installation"),(0,a.kt)("p",null,"You can install the nestjs-authentication module using npm:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install --save @trxn/nestjs-authentication\n")),(0,a.kt)("h2",{id:"getting-started"},"Getting Started"),(0,a.kt)("p",null,"In your workspace create you own AuthenticationModule that will configure the AuthenticationModule."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Module } from '@nestjs/common';\n\nimport { AuthenticationModule } from '@trxn/nestjs-authentication';\nimport { UserModule } from './user.module';\n\n@Module({\n  imports: [AuthenticationModule.register({\n    imports: [UserModule]\n  })],\n})\nexport class AppModule {}\n")),(0,a.kt)("p",null,"The UserModule here is the UserModule provided by ",(0,a.kt)("inlineCode",{parentName:"p"},"@trxn/nestjs-user")," and that expose\na UserService. You can use your own UserService class by providing it directly in the options:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Module } from '@nestjs/common';\n\nimport { AuthenticationModule } from '@trxn/nestjs-authentication';\nimport { UserModule } from './user.module';\n\n@Module({\n  imports: [AuthenticationModule.register({\n    UserService: MyUserServiceClass\n  })],\n})\nexport class AppModule {}\n")),(0,a.kt)("p",null,"The UserService property respect the nestjs Provider type."),(0,a.kt)("h2",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,"After the first configuration your routes are not yet protected. Authentication Module\ngive access to you to some guard class that you can use across your project. One of\nthe best method to authenticate your application is to force the authentication to\nall the routes of your application and whitelist only the route that you need to be\npublic. To do so AuthenticationModule give you access a guard and a decorator ",(0,a.kt)("inlineCode",{parentName:"p"},"@Public"),"\nto mark the route as public."),(0,a.kt)("p",null,"Here an example to authenticate all your routes:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import {\n  AuthenticationModule,\n  JwtGlobalAuthGuard,\n} from '@trxn/nestjs-authentication';\n\n@Module({\n  imports: [\n    AuthenticationModule.register(\n      //... provide a UserService class\n    ),\n  ],\n  controllers: [],\n  providers: [\n    {\n      provide: APP_GUARD,\n      useClass: JwtGlobalAuthGuard,\n    },\n  ],\n})\nexport class AppModule {}\n")),(0,a.kt)("h2",{id:"customuserselect"},"CustomUserSelect"),(0,a.kt)("p",null,"The AuthenticationModule is responsible to hydrate you user when a request hit your api.\nSome time you don't want only the user but you want to join some data attached to it.\nThis module let you configured a object that will be used in junction with the `UserService``\nprovided to select the information to use to fetch the user."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"@Module({\n  imports: [\n    AuthenticationModule.register(\n      //... the UserService configuration\n\n      customSelect: {\n        id: true,\n        roles: true,\n        profile: {\n          name: true,\n          address: true,\n          // ...\n        }\n      }\n    ),\n  ],\n  controllers: [],\n  providers: [\n    {\n      provide: APP_GUARD,\n      useClass: JwtGlobalAuthGuard,\n    },\n  ],\n})\nexport cla\n\n## Cookie authentication\n\nYou need if you want to use the authentication from cookie to add the cookie\nparser package to your app module. You can look at the\n[nestjs documentation](https://docs.nestjs.com/techniques/cookies#cookies).\n**You must provide one or more secret to the cookie-parser package**,\n`nestjs-authentication` use only signedCookie in production mode.\n\n```typescript\nimport * as cookieParser from 'cookie-parser';\n// somewhere in your initialization file\napp.use(cookieParser('myScret'));\n")),(0,a.kt)("h2",{id:"encryption"},"Encryption"),(0,a.kt)("p",null,"By default AuthenticationModule use Bcrypt to parse and read the password.\nIf you need to use something else you can provide to the AuthenticationModule your own\n",(0,a.kt)("inlineCode",{parentName:"p"},"EncryptionService")," that need to implement a ",(0,a.kt)("inlineCode",{parentName:"p"},"compare")," and a ",(0,a.kt)("inlineCode",{parentName:"p"},"hash")," method."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"@Module({\n  imports: [\n    AuthenticationModule.register(\n      //... provide a UserService class\n      EncryptionService: EncryptionService\n    ),\n  ],\n  controllers: [],\n  providers: [\n    {\n      provide: APP_GUARD,\n      useClass: JwtGlobalAuthGuard,\n    },\n  ],\n})\nexport class AppModule {}\n")),(0,a.kt)("p",null,"You can look at the BcryptModule to found some example."),(0,a.kt)("h2",{id:"bcrypt-online-generator"},"Bcrypt online generator"),(0,a.kt)("p",null,"To be able to test you can use these ",(0,a.kt)("a",{parentName:"p",href:"https://www.browserling.com/tools/bcrypt"},"bcrypt online generator")," to crypt your passwords."))}c.isMDXComponent=!0;var l=["components"],p={id:"use-nestjs-authentication",hide_title:!0,sidebar_label:"Authenticate your routes"},d=void 0,h={unversionedId:"how-to/authentication/use-nestjs-authentication",id:"how-to/authentication/use-nestjs-authentication",title:"use-nestjs-authentication",description:"",source:"@site/docs/how-to/authentication/1-use-nestjs-authentication copy.mdx",sourceDirName:"how-to/authentication",slug:"/how-to/authentication/use-nestjs-authentication",permalink:"/docs/how-to/authentication/use-nestjs-authentication",draft:!1,editUrl:"https://github.com/tractr/traxion/tree/main/apps/docs/docs/how-to/authentication/1-use-nestjs-authentication copy.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"use-nestjs-authentication",hide_title:!0,sidebar_label:"Authenticate your routes"},sidebar:"documentation",previous:{title:"The user module",permalink:"/docs/how-to/authentication/use-nestjs-user"},next:{title:"Authorization",permalink:"/docs/how-to/authentication/use-nestjs-casl"}},f={},y=[],m={toc:y},v="wrapper";function b(e){var t=e.components,n=(0,r.Z)(e,l);return(0,a.kt)(v,(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(c,{mdxType:"SourceMarkdown"}))}b.isMDXComponent=!0},3426:(e,t)=>{var n=Symbol.for("react.element"),o=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function b(){}function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var k=g.prototype=new b;k.constructor=g,y(k,v.prototype),k.isPureReactComponent=!0;var w=Array.isArray,j=Object.prototype.hasOwnProperty,S={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,o){var r,a={},i=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(i=""+t.key),t)j.call(t,r)&&!M.hasOwnProperty(r)&&(a[r]=t[r]);var s=arguments.length-2;if(1===s)a.children=o;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===a[r]&&(a[r]=s[r]);return{$$typeof:n,type:e,key:i,ref:u,props:a,_owner:S.current}}function _(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function O(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,r,a,i){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case o:s=!0}}if(s)return i=i(s=e),e=""===a?"."+O(s,0):a,w(i)?(r="",null!=e&&(r=e.replace(x,"$&/")+"/"),P(i,t,r,"",(function(e){return e}))):null!=i&&(_(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(x,"$&/")+"/")+e)),t.push(i)),1;if(s=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var l=a+O(u=e[c],c);s+=P(u,t,r,l,i)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=P(u=u.value,t,r,l=a+O(u,c++),i);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function C(e,t,n){if(null==e)return e;var o=[],r=0;return P(e,o,"","",(function(e){return t.call(n,e,r++)})),o}function U(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},T={transition:null}},2784:(e,t,n)=>{n(3426)}}]);